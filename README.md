# Readme

Hi =)

This code accompanies the paper: Michael Fraiman, Paulina Hoyos, Tamir Bendory, Joe Kileel, Oscar Micklein, Nir Sharon, Amit Singer, "SO(3)-invariant PCA with application to molecular data", arXiv:2510.18827 (2025)."

If you want to use the code or cite it, please cite the paper.

*The `.mat` files need to be in the `mat_converted_N={NN}`* folder, where `NN` is the resolution (that is, the volumes are $N \times N \times N$)

1. The script `final_cov_matr_centered.py` builds the globally centered covariance matrix. Then it expands each volume in the eigebasis of this matrix.

2. The script `final_plot_energy_PCA.py` plots the comparison graphs of the energy. *Currently should not be used --- I need to remove the uncentered stuff*

3. `final_top_eigenvolumes_reconstruct.py` takes the eigenvolumes generated by `final_cov_matr_centered.py` and generates `.mrc` files.

4. `final_volumes_reconstruction.py` approximates the target volumes (variable `TARGETS` in the code) using the top `K` eigenvolumes where `K` runs in `K_LIST`. Curently it also reconstructs the original, so it loads all coefficients, but we can remove that in the future.

5. `final_expand_FB.py` expands the target volumes is the Spherical Fourier--Bessel basis.

6. `final_energy_four-bes_basis.py` plots the Fourier--Bessel energy.

7. `final_compare_PCA_F-B.py` plots three curves showing cumulative energy: PCA, SFB sorted, SFB u-sorted.

8. `final_expand_volumes_in_PCA_basis.py` saves the top `K_TOP_WANT` coefficients of the PCA expansion.

9. `fake_get_distributions.py` finds the distributions of the coefficients in the PCA basis.